<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="univariateML">
<title>Overview of univariateML â€¢ univariateML</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Overview of univariateML">
<meta property="og:description" content="univariateML">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">univariateML</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/copula.html">Copula Modeling</a>
    <a class="dropdown-item" href="../articles/distributions.html">Distributions</a>
    <a class="dropdown-item" href="../articles/overview.html">Overview of univariateML</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JonasMoss/univariateML/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="overview_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Overview of univariateML</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JonasMoss/univariateML/blob/HEAD/vignettes/overview.Rmd" class="external-link"><code>vignettes/overview.Rmd</code></a></small>
      <div class="d-none name"><code>overview.Rmd</code></div>
    </div>

    
    
<p>When dealing with univariate data you want to do one or more of</p>
<ul>
<li>Find a good model for the data.</li>
<li>Estimate parameters for your candidate models.</li>
<li>Get an idea about the uncertainty of your estimates.</li>
</ul>
<p>The <code>unvariateML</code> package has a fast and reliable functions to help you with these tasks. The core of the package are more than 20 functions for fast and thoroughly tested calculation of maximum likelihood estimates for univariate models.</p>
<ul>
<li>Compare the fit of your candidate models with <code>AIC</code> or <code>BIC</code>.</li>
<li>Look at QQ plots or PP plots of your data.</li>
<li>Plot the data together with density estimates.</li>
<li>Compute confidence intervals using parametric bootstrap.</li>
</ul>
<p>This vignette shows you how to use the tools of <code>univariateML</code> to do exploratory data analysis.</p>
<div class="section level2">
<h2 id="mortality-in-ancient-egypt">Mortality in Ancient Egypt<a class="anchor" aria-label="anchor" href="#mortality-in-ancient-egypt"></a>
</h2>
<p>The dataset <code>egypt</code> contains contains the age at death of 141 Roman era Egyptian mummies. Our first task is to find a univariate model that fits this data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/JonasMoss/univariateML" class="external-link">"univariateML"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    age  sex</span>
<span class="co">## 1 1.50 male</span>
<span class="co">## 2 1.83 male</span>
<span class="co">## 3 2.00 male</span>
<span class="co">## 4 2.00 male</span>
<span class="co">## 5 3.00 male</span>
<span class="co">## 6 3.00 male</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span>, main <span class="op">=</span> <span class="st">"Mortality in Ancient Egypt"</span>, freq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="overview_files/figure-html/egypt-1.png" width="576"></p>
<div class="section level3">
<h3 id="comparing-many-models-with-aic">Comparing Many Models with AIC<a class="anchor" aria-label="anchor" href="#comparing-many-models-with-aic"></a>
</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion" class="external-link">AIC</a> is a handy and easy to use model selection tool, as it only depends on the log-likelihood and number of parameters of the models. The  generic in <code>R</code> can take multiple models, and the lower the  the better.</p>
<p>Since all the data is positive we will only try densities support on the positive half-line.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlbetapr.html">mlbetapr</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mlexp.html">mlexp</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mlinvgamma.html">mlinvgamma</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mlgamma.html">mlgamma</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mllnorm.html">mllnorm</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mlrayleigh.html">mlrayleigh</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mlinvgauss.html">mlinvgauss</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mlinvweibull.html">mlinvweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/mllgamma.html">mllgamma</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                         df      AIC</span>
<span class="co">## mlbetapr(egypt$age)      2 1312.464</span>
<span class="co">## mlexp(egypt$age)         1 1249.553</span>
<span class="co">## mlinvgamma(egypt$age)    2 1322.949</span>
<span class="co">## mlgamma(egypt$age)       2 1234.772</span>
<span class="co">## mllnorm(egypt$age)       2 1263.874</span>
<span class="co">## mlrayleigh(egypt$age)    1 1260.217</span>
<span class="co">## mlinvgauss(egypt$age)    2 1287.124</span>
<span class="co">## mlweibull(egypt$age)     2 1230.229</span>
<span class="co">## mlinvweibull(egypt$age)  2 1319.120</span>
<span class="co">## mllgamma(egypt$age)      2 1314.187</span></code></pre>
<p>The <a href="https://en.wikipedia.org/wiki/Weibull_distribution" class="external-link">Weibull</a> and <a href="https://en.wikipedia.org/wiki/Gamma_distribution" class="external-link">Gamma</a> models stand out with an AIC far below the other candidate models.</p>
<p>To see the parameter estimates of <code>mlweibull(egypt$age)</code> just print it:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Maximum likelihood estimates for the Weibull model </span>
<span class="co">##  shape   scale  </span>
<span class="co">##  1.404  33.564</span></code></pre>
<p><code>mlweibull(egypt$age)</code> is a <code>univariateML</code> object. For more details about it call <code>summary</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Maximum likelihood for the Weibull model </span>
<span class="co">##  </span>
<span class="co">## Call:  mlweibull(x = egypt$age) </span>
<span class="co">## </span>
<span class="co">## Estimates: </span>
<span class="co">##     shape      scale  </span>
<span class="co">##  1.404158  33.563564  </span>
<span class="co">## </span>
<span class="co">## Data:            egypt$age (141 obs.)</span>
<span class="co">## Support:         (0, Inf)</span>
<span class="co">## Density:         stats::dweibull</span>
<span class="co">## Log-likelihood:  -613.1144</span></code></pre>
</div>
<div class="section level3">
<h3 id="automatically-select-the-best-model">Automatically select the best model<a class="anchor" aria-label="anchor" href="#automatically-select-the-best-model"></a>
</h3>
<p>The model selection process can be automatized with <code>model_select(egypt$age)</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/model_select.html">model_select</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span>, models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gamma"</span>, <span class="st">"weibull"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Maximum likelihood estimates for the Weibull model </span>
<span class="co">##  shape   scale  </span>
<span class="co">##  1.404  33.564</span></code></pre>
</div>
<div class="section level3">
<h3 id="quantile-quantile-plots">Quantile-quantile Plots<a class="anchor" aria-label="anchor" href="#quantile-quantile-plots"></a>
</h3>
<p>Now we will investigate how the two models differ with <a href="https://en.wikipedia.org/wiki/Q-Q_plot" class="external-link">quantile-quantile plots</a>, or Q-Q plots for short.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ProbabilityPlots.html">qqmlplot</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span>, <span class="va">mlweibull</span>, datax <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"QQ Plot for Ancient Egypt"</span><span class="op">)</span>
<span class="co"># Can also use qqmlplot(mlweibull(egypt$age), datax = TRUE) directly.</span>
<span class="fu"><a href="../reference/ProbabilityPlots.html">qqmlpoints</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span>, <span class="va">mlgamma</span>, datax <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="../reference/ProbabilityPlots.html">qqmlline</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span>, <span class="va">mlweibull</span>, datax <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/ProbabilityPlots.html">qqmlline</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span>, <span class="va">mlgamma</span>, datax <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="overview_files/figure-html/qqplots-1.png" width="576"></p>
<p>The Q-Q plot shows that neither Weibull nor Gamma fits the data very well.</p>
<p>If you prefer P-P plots to Q-Q plots take a look at <code>?ppplotml</code> instead.</p>
</div>
<div class="section level3">
<h3 id="plot-densities">Plot Densities<a class="anchor" aria-label="anchor" href="#plot-densities"></a>
</h3>
<p>Use the <code>plot</code>, <code>lines</code> and <code>points</code> generics to plot the densities.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span>, main <span class="op">=</span> <span class="st">"Mortality in Ancient Egypt"</span>, freq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlgamma.html">mlgamma</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></code></pre></div>
<p><img src="overview_files/figure-html/plot_example-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="confidence-intervals-with-parametric-bootstrap">Confidence Intervals with Parametric Bootstrap<a class="anchor" aria-label="anchor" href="#confidence-intervals-with-parametric-bootstrap"></a>
</h3>
<p>Now we want to get an idea about the uncertainties of our model parameters. Do to this we can do a parametric bootstrap to calculate confidence intervals using either <code>bootstrapml</code> or <code>confint</code>. While <code>bootstrapml</code> allows you to calculate any functional of the parameters and manipulate them afterwards, <code>confint</code> is restricted to the main parameters of the model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate two-sided 95% confidence intervals for the two Gumbel parameters.</span>
<span class="fu"><a href="../reference/bootstrapml.html">bootstrapml</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="co"># same as confint(mlweibull(egypt$age))</span></code></pre></div>
<pre><code><span class="co">##            2.5%     97.5%</span>
<span class="co">## shape  1.245265  1.633578</span>
<span class="co">## scale 29.637221 37.966963</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bootstrapml.html">bootstrapml</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlgamma.html">mlgamma</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##             2.5%      97.5%</span>
<span class="co">## shape 1.32063094 2.04494582</span>
<span class="co">## rate  0.04175345 0.06965108</span></code></pre>
<p>These confidence intervals are not directly comparable. That is, the <code>scale</code> parameter in the Weibull model is not directly comparable to the <code>rate</code> parameter in the gamma model. So let us take a look at a a parameter with a familiar interpretation, namely the mean.</p>
<p>The mean of the Weibull distribution with parameters <code>shape</code> and <code>scale</code> is <code>scale*gamma(1 + 1/shape)</code>. On the other hand, the mean of the Gamma distribution with parameters <code>shape</code> and <code>rate</code> is <code>shape/rate</code>.</p>
<p>The <code>probs</code> argument can be used to modify the limits of confidence interval. Now we will calculate two 90% confidence intervals for the mean.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate two-sided 90% confidence intervals for the mean of a Weibull.</span>
<span class="fu"><a href="../reference/bootstrapml.html">bootstrapml</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, 
            map <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, 
            probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       5%      95% </span>
<span class="co">## 27.60487 33.71763</span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate two-sided 90% confidence intervals for the mean of a Gamma.</span>
<span class="fu"><a href="../reference/bootstrapml.html">bootstrapml</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlgamma.html">mlgamma</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, 
            map <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
            probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       5%      95% </span>
<span class="co">## 27.58473 34.00721</span></code></pre>
<p>We are be interested in the quantiles of the underlying distribution, for instance the median:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate two-sided 90% confidence intervals for the two Gumbel parameters.</span>
<span class="fu"><a href="../reference/bootstrapml.html">bootstrapml</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, 
            map <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">qweibull</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, 
            probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       5%      95% </span>
<span class="co">## 23.10312 28.84421</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bootstrapml.html">bootstrapml</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlgamma.html">mlgamma</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, 
            map <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">qgamma</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, 
            probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       5%      95% </span>
<span class="co">## 21.77007 27.63784</span></code></pre>
<p>We can also plot the bootstrap samples.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="../reference/bootstrapml.html">bootstrapml</a></span><span class="op">(</span><span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, 
                 map <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, 
                 reducer <span class="op">=</span> <span class="va">identity</span><span class="op">)</span>,
     main <span class="op">=</span> <span class="st">"Bootstrap Samples of the Mean"</span>,
     xlab <span class="op">=</span> <span class="st">"x"</span>,
     freq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="overview_files/figure-html/bootstrap_example_histogram-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="density-cdf-quantiles-and-random-variate-generation">Density, CDF, quantiles and random variate generation<a class="anchor" aria-label="anchor" href="#density-cdf-quantiles-and-random-variate-generation"></a>
</h3>
<p>The functions <code>dml</code>, <code>pml</code>, <code>qml</code> and <code>rml</code> can be used to calculate densities, cumulative probabilities, quantiles, and generate random variables. Here are <span class="math inline">\(10\)</span> random observations from the most likely distribution of Egyptian mortalities given the Weibull model.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">313</span><span class="op">)</span>
<span class="fu"><a href="../reference/MaximumLikelihoodDistribution.html">rml</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1] 25.90552 59.64456 13.36882 44.29378 12.22563 17.66144 54.57633 22.86824</span>
<span class="co">##  [9] 11.48328 19.94814</span></code></pre>
<p>Compare the empirical distribution of the random variates to the true cumulative probability.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">313</span><span class="op">)</span>
<span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/mlweibull.html">mlweibull</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>
<span class="va">q</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">egypt</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">q</span>, <span class="fu"><a href="../reference/MaximumLikelihoodDistribution.html">pml</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">obj</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"Cumulative Probability"</span><span class="op">)</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../reference/MaximumLikelihoodDistribution.html">rml</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">obj</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="overview_files/figure-html/cumulative%20probability-1.png" width="576"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jonas Moss.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
