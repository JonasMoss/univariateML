<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of univariateML â€¢ univariateML</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview of univariateML">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">univariateML</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/copula.html">Copula Modeling</a>
    </li>
    <li>
      <a href="../articles/distributions.html">Distributions</a>
    </li>
    <li>
      <a href="../articles/overview.html">Overview of univariateML</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JonasMoss/univariateML">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Overview of univariateML</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JonasMoss/univariateML/blob/master/vignettes/overview.Rmd"><code>vignettes/overview.Rmd</code></a></small>
      <div class="hidden name"><code>overview.Rmd</code></div>

    </div>

    
    
<p>When dealing with univariate data you want to do one or more of * Find a good model for the data. * Estimate parameters for your candidate models. * Get an idea about the uncertainty of your estimates.</p>
<p>The <code>unvariateML</code> package has a fast and reliable functions to help you with these tasks. The core of the package are more than 20 functions for fast and thoroughly tested calculation of maximum likelihood estimates for univariate models.</p>
<ul>
<li>Compare the fit of your candidate models with <code>AIC</code> or <code>BIC</code>.</li>
<li>Look at QQ plots or PP plots of your data.</li>
<li>Plot the data together with density estimates.</li>
<li>Compute confidence intervals using parametric bootstrap.</li>
</ul>
<p>This vignette shows you how to use the tools of <code>univariateML</code> to do exploratory data analysis.</p>
<div id="mortality-in-ancient-egypt" class="section level1">
<h1 class="hasAnchor">
<a href="#mortality-in-ancient-egypt" class="anchor"></a>Mortality in Ancient Egypt</h1>
<p>The dataset <code>egypt</code> contains contains the age at death of 141 Roman era Egyptian mummies. Our first task is to find a univariate model that fits this data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"univariateML"</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(egypt)</a></code></pre></div>
<pre><code>##    age  sex
## 1 1.50 male
## 2 1.83 male
## 3 2.00 male
## 4 2.00 male
## 5 3.00 male
## 6 3.00 male</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(egypt<span class="op">$</span>age, <span class="dt">main =</span> <span class="st">"Mortality in Ancient Egypt"</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="overview_files/figure-html/egypt-1.png" width="576"></p>
<div id="comparing-many-models-with-aic" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-many-models-with-aic" class="anchor"></a>Comparing Many Models with AIC</h2>
<p>The <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion">AIC</a> is a handy and easy to use model selection tool, as it only depends on the log-likelihood and number of parameters of the models. The  generic in <code>R</code> can take multiple models, and the lower the  the better.</p>
<p>Since all the data is positive we will only try densities support on the positive half-line.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(<span class="kw"><a href="../reference/mlbetapr.html">mlbetapr</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-2" title="2">    <span class="kw"><a href="../reference/mlexp.html">mlexp</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="kw"><a href="../reference/mlinvgamma.html">mlinvgamma</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="kw"><a href="../reference/mlgamma.html">mlgamma</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="kw"><a href="../reference/mllnorm.html">mllnorm</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="kw"><a href="../reference/mlrayleigh.html">mlrayleigh</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="kw"><a href="../reference/mlinvgauss.html">mlinvgauss</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-8" title="8">    <span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="kw"><a href="../reference/mlinvweibull.html">mlinvweibull</a></span>(egypt<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="kw"><a href="../reference/mllgamma.html">mllgamma</a></span>(egypt<span class="op">$</span>age))</a></code></pre></div>
<pre><code>##                         df      AIC
## mlbetapr(egypt$age)      2 1312.464
## mlexp(egypt$age)         1 1249.553
## mlinvgamma(egypt$age)    2 1322.949
## mlgamma(egypt$age)       2 1234.772
## mllnorm(egypt$age)       2 1263.874
## mlrayleigh(egypt$age)    1 1260.217
## mlinvgauss(egypt$age)    2 1287.124
## mlweibull(egypt$age)     2 1230.229
## mlinvweibull(egypt$age)  2 1319.120
## mllgamma(egypt$age)      2 1314.187</code></pre>
<p>The <a href="https://en.wikipedia.org/wiki/Weibull_distribution">Weibull</a> and <a href="https://en.wikipedia.org/wiki/Gamma_distribution">Gamma</a> models stand out with an AIC far below the other candidate models.</p>
<p>To see the parameter estimates of <code><a href="../reference/mlweibull.html">mlweibull(egypt$age)</a></code> just print it:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age)</a></code></pre></div>
<pre><code>## Maximum likelihood estimates for the Weibull model 
##  shape   scale  
##  1.404  33.564</code></pre>
<p><code><a href="../reference/mlweibull.html">mlweibull(egypt$age)</a></code> is a <code>univariateML</code> object. For more details about it call <code>summary</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age))</a></code></pre></div>
<pre><code>## 
## Maximum likelihood for the Weibull model 
##  
## Call:  mlweibull(x = egypt$age) 
## 
## Estimates: 
##     shape      scale  
##  1.404158  33.563564  
## 
## Data:            egypt$age (141 obs.)
## Support:         (0, Inf)
## Density:         stats::dweibull
## Log-likelihood:  -613.1144</code></pre>
</div>
<div id="quantile-quantile-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#quantile-quantile-plots" class="anchor"></a>Quantile-quantile Plots</h2>
<p>Now we will investigate how the two models differ with <a href="quantile-quantile%20plots">https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot</a>, or Q-Q plots for short.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="../reference/ProbabilityPlots.html">qqmlplot</a></span>(egypt<span class="op">$</span>age, mlweibull, <span class="dt">datax =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">"QQ Plot for Ancient Egypt"</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co"># Can also use qqmlplot(mlweibull(egypt$age), datax = TRUE) directly.</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw"><a href="../reference/ProbabilityPlots.html">qqmlpoints</a></span>(egypt<span class="op">$</span>age, mlgamma, <span class="dt">datax =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw"><a href="../reference/ProbabilityPlots.html">qqmlline</a></span>(egypt<span class="op">$</span>age, mlweibull, <span class="dt">datax =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw"><a href="../reference/ProbabilityPlots.html">qqmlline</a></span>(egypt<span class="op">$</span>age, mlgamma, <span class="dt">datax =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">"red"</span>)</a></code></pre></div>
<p><img src="overview_files/figure-html/qqplots-1.png" width="576"></p>
<p>The Q-Q plot shows that neither Weibull nor Gamma fits the data very well.</p>
<p>If you prefer P-P plots to Q-Q plots take a look at <code>?ppplotml</code> instead.</p>
</div>
<div id="plot-densities" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-densities" class="anchor"></a>Plot Densities</h2>
<p>Use the <code>plot</code>, <code>lines</code> and <code>points</code> generics to plot the densities.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(egypt<span class="op">$</span>age, <span class="dt">main =</span> <span class="st">"Mortality in Ancient Egypt"</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="fl">0.025</span>))</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw"><a href="../reference/mlgamma.html">mlgamma</a></span>(egypt<span class="op">$</span>age), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="kw"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span>(egypt<span class="op">$</span>age)</a></code></pre></div>
<p><img src="overview_files/figure-html/plot_example-1.png" width="576"></p>
</div>
<div id="confidence-intervals-with-parametric-bootstrap" class="section level2">
<h2 class="hasAnchor">
<a href="#confidence-intervals-with-parametric-bootstrap" class="anchor"></a>Confidence Intervals with Parametric Bootstrap</h2>
<p>Now we want to get an idea about the uncertainties of our model parameters. Do do this we can do a parametric bootstrap to calculate confidence intervals using either <code>bootstrapml</code> or <code>confint</code>. While <code>bootstrapml</code> allows you to calculate any functional of the parameters and manipulate them afterwards, <code>confint</code> is restricted to the main parameters of the model.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Calculate two-sided 95% confidence intervals for the two Gumbel parameters.</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw"><a href="../reference/bootstrapml.html">bootstrapml</a></span>(<span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age)) <span class="co"># same as confint(mlweibull(egypt$age))</span></a></code></pre></div>
<pre><code>##            2.5%     97.5%
## shape  1.249535  1.618375
## scale 29.632580 37.961831</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="../reference/bootstrapml.html">bootstrapml</a></span>(<span class="kw"><a href="../reference/mlgamma.html">mlgamma</a></span>(egypt<span class="op">$</span>age))</a></code></pre></div>
<pre><code>##             2.5%      97.5%
## shape 1.33668712 2.01079214
## rate  0.04214615 0.06773234</code></pre>
<p>These confidence intervals are not directly comparable. That is, the <code>scale</code> parameter in the Weibull model is not directly comparable to the <code>rate</code> parameter in the gamma model. So let us take a look at a a parameter with a familiar interpretation, namely the mean.</p>
<p>The mean of the Weibull distribution with parameters <code>shape</code> and <code>scale</code> is <code>scale*gamma(1 + 1/shape)</code>. On the other hand, the mean of the Gamma distribution with parameters <code>shape</code> and <code>rate</code> is <code>shape/rate</code>.</p>
<p>The <code>probs</code> argument can be used to modify the limits of confidence interval. Now we will calculate two 90% confidence intervals for the mean.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># Calculate two-sided 90% confidence intervals for the mean of a Weibull.</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw"><a href="../reference/bootstrapml.html">bootstrapml</a></span>(<span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age), </a>
<a class="sourceLine" id="cb16-3" title="3">            <span class="dt">map =</span> <span class="cf">function</span>(x) x[<span class="dv">2</span>]<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>x[<span class="dv">1</span>]), </a>
<a class="sourceLine" id="cb16-4" title="4">            <span class="dt">probs =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##       5%      95% 
## 27.72577 33.71598</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># Calculate two-sided 90% confidence intervals for the mean of a Gamma.</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw"><a href="../reference/bootstrapml.html">bootstrapml</a></span>(<span class="kw"><a href="../reference/mlgamma.html">mlgamma</a></span>(egypt<span class="op">$</span>age), </a>
<a class="sourceLine" id="cb18-3" title="3">            <span class="dt">map =</span> <span class="cf">function</span>(x) x[<span class="dv">1</span>]<span class="op">/</span>x[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb18-4" title="4">            <span class="dt">probs =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##       5%      95% 
## 27.55772 34.15678</code></pre>
<p>We are be interested in the quantiles of the underlying distribution, for instance the median:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># Calculate two-sided 90% confidence intervals for the two Gumbel parameters.</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw"><a href="../reference/bootstrapml.html">bootstrapml</a></span>(<span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age), </a>
<a class="sourceLine" id="cb20-3" title="3">            <span class="dt">map =</span> <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/stats/Weibull.html">qweibull</a></span>(<span class="fl">0.5</span>, x[<span class="dv">1</span>], x[<span class="dv">2</span>]), </a>
<a class="sourceLine" id="cb20-4" title="4">            <span class="dt">probs =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##       5%      95% 
## 22.92392 29.03437</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw"><a href="../reference/bootstrapml.html">bootstrapml</a></span>(<span class="kw"><a href="../reference/mlgamma.html">mlgamma</a></span>(egypt<span class="op">$</span>age), </a>
<a class="sourceLine" id="cb22-2" title="2">            <span class="dt">map =</span> <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/stats/GammaDist.html">qgamma</a></span>(<span class="fl">0.5</span>, x[<span class="dv">1</span>], x[<span class="dv">2</span>]), </a>
<a class="sourceLine" id="cb22-3" title="3">            <span class="dt">probs =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##       5%      95% 
## 21.89397 27.73286</code></pre>
<p>We can also plot the bootstrap samples.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="kw"><a href="../reference/bootstrapml.html">bootstrapml</a></span>(<span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age), </a>
<a class="sourceLine" id="cb24-2" title="2">                 <span class="dt">map =</span> <span class="cf">function</span>(x) x[<span class="dv">2</span>]<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>x[<span class="dv">1</span>]), </a>
<a class="sourceLine" id="cb24-3" title="3">                 <span class="dt">reducer =</span> identity),</a>
<a class="sourceLine" id="cb24-4" title="4">     <span class="dt">main =</span> <span class="st">"Bootstrap Samples of the Mean"</span>,</a>
<a class="sourceLine" id="cb24-5" title="5">     <span class="dt">xlab =</span> <span class="st">"x"</span>,</a>
<a class="sourceLine" id="cb24-6" title="6">     <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="overview_files/figure-html/bootstrap_example_historgram-1.png" width="576"></p>
</div>
<div id="density-cdf-quantiles-and-random-variate-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#density-cdf-quantiles-and-random-variate-generation" class="anchor"></a>Density, CDF, quantiles and random variate generation</h2>
<p>The functions <code>dml</code>, <code>pml</code>, <code>qml</code> and <code>rml</code> can be used to calculate densities, cumulative probabilities, quantiles, and generate random variables. Here are <span class="math inline">\(10\)</span> random observations from the most likely distribution of Egyptian mortalities given the Weibull model.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">313</span>)</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw"><a href="../reference/MaximumLikelihoodDistribution.html">rml</a></span>(<span class="dv">10</span>, <span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age))</a></code></pre></div>
<pre><code>##  [1] 25.90552 59.64456 13.36882 44.29378 12.22563 17.66144 54.57633
##  [8] 22.86824 11.48328 19.94814</code></pre>
<p>Compare the empirical distribution of the random variates to the true cumulative probability.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">313</span>)</a>
<a class="sourceLine" id="cb27-2" title="2">obj =<span class="st"> </span><span class="kw"><a href="../reference/mlweibull.html">mlweibull</a></span>(egypt<span class="op">$</span>age)</a>
<a class="sourceLine" id="cb27-3" title="3">q =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(egypt<span class="op">$</span>age), <span class="dt">length.out =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb27-4" title="4"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(q, <span class="kw"><a href="../reference/MaximumLikelihoodDistribution.html">pml</a></span>(q, obj), <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">ylab =</span> <span class="st">"Cumulative Probability"</span>)</a>
<a class="sourceLine" id="cb27-5" title="5">r =<span class="st"> </span><span class="kw"><a href="../reference/MaximumLikelihoodDistribution.html">rml</a></span>(<span class="dv">100</span>, obj)</a>
<a class="sourceLine" id="cb27-6" title="6"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span>(r))</a></code></pre></div>
<p><img src="overview_files/figure-html/cumulative%20probability-1.png" width="576"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#mortality-in-ancient-egypt">Mortality in Ancient Egypt</a><ul class="nav nav-pills nav-stacked">
<li><a href="#comparing-many-models-with-aic">Comparing Many Models with AIC</a></li>
      <li><a href="#quantile-quantile-plots">Quantile-quantile Plots</a></li>
      <li><a href="#plot-densities">Plot Densities</a></li>
      <li><a href="#confidence-intervals-with-parametric-bootstrap">Confidence Intervals with Parametric Bootstrap</a></li>
      <li><a href="#density-cdf-quantiles-and-random-variate-generation">Density, CDF, quantiles and random variate generation</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://burnishedmossite.netlify.com">Jonas Moss</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
